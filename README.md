THE CODE IS SEPERATED ROUGHLY IN 2 BRANCHES
